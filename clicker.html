<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style/style_clicker.css">
    <title id="title"></title>
</head>
<body>

<div id="main-outer-div">

<button id="plant-button" onclick="clickPlant()" style="cursor: pointer; z-index: 1000;">
    <img style="width: 500;" class="empty" id="plant"/>
</button>

<div style="position: absolute;">
    <div id="positional-div" style="top: -50px; left: 0px;">
        <div id="seed-counter"></div>
        <div id="seed-per-second"></div>
    </div>
</div>

<div style="position: absolute;">
    <div id="positional-div" style="top: 90px; left: 0px;">
        <button id="upgrade-button-outer" onclick="plantPlot.buy(1)" style="cursor: pointer; z-index: 1000;">
            <div id="upgrade-button-inner">
                <div id="plant-plot-counter-part-1"></div>
                <div id="plant-plot-counter-part-2"></div>
            </div>
            <div id="plant-plot-price"></div>
        </button>
    </div>
</div>

<div style="position: absolute;">
    <div id="positional-div" style="top: 120px; left: 500px;">
        <div>hi</div>
    </div>
</div>

<div style="position: absolute;">
    <line id="connector" x1="-50" y1="0" x2="80" y2="0" 
                stroke="black" stroke-width="2"/>
</div>

</div>

<script>

class plantType {
    constructor(name, ripeAge, seedProduceAmount, sprites) {
        this.name = name;
        this.ripeAge = ripeAge;
        this.seedProduceAmount = seedProduceAmount;
        this.sprites = sprites;
        this.age = 0;
    }
    grow() {
        this.age++;
        plant.removeAttribute("class")
        plant.classList.add(this.sprites+String(this.age));
        if(this.age > this.ripeAge) {
            this.age = 0;
            plantExists = false;
            plant.removeAttribute("class")
            plant.classList.add("empty");
            return this.seedProduceAmount;
        } else {
            return 0;
        }
    }
    getSeedProduceAmount() {
        return(this.seedProduceAmount)
    }
}

class upgradeType {
    constructor(name, startingPriceConstant, equation) {
        this.name = name;
        this.startingPriceConstant = startingPriceConstant;
        this.equation = equation
        this.amountOwned = 0;
        this.growthConstant = 1;
    }
    getAmountOwned() {
        return(this.amountOwned);
    }
    getPrice() {
        return(Math.floor((0.25 * (this.amountOwned + 10) * this.amountOwned + 3) * this.startingPriceConstant));
    }
    buy(amount) {
        var price = this.getPrice();
        if(seeds >= price*amount) {
            seeds -= price*amount;
            this.amountOwned += amount;
        }
    }
    seedsPerSecondCalulation() {
        return(this.equation * this.amountOwned);
    }
    produceEquation(timeConstant) {
        seeds += (this.seedsPerSecondCalulation()) / timeConstant;
    }
}

const plant = document.getElementById("plant");
const title = document.getElementById("title");
const seedCounter = document.getElementById("seed-counter");
const seedPerSecondDisplay = document.getElementById("seed-per-second");

const plantPlotCounterPart1 = document.getElementById("plant-plot-counter-part-1");
const plantPlotCounterPart2 = document.getElementById("plant-plot-counter-part-2");
const plantPlotPrice = document.getElementById("plant-plot-price");

const grass = new plantType("grass", 3, 2, "grass");
var currentPlant = grass;

const plantPlot = new upgradeType("plant plot", 1.7, currentPlant.getSeedProduceAmount() - 1)

var seeds = 1;
var previousSeeds = 0;
var seedsPerSecond = 0;
var plantExists;

function wake(){
    setInterval(() => update(), 10);
    setInterval(() => seedPerSecondCalculator(), 1000);
    setInterval(() => plantPlot.produceEquation(100), 10);
}

function update(){
    if(seeds === 1) {title.textContent = Math.floor(seeds)+ " seed";}
    else{title.textContent = Math.floor(seeds)+ " seeds";}
    if(seeds === 1) {seedCounter.textContent = Math.floor(seeds)+ " seed";}
    else{seedCounter.textContent = Math.floor(seeds)+ " seeds";}

    if(plantPlot.getAmountOwned() === 1) {plantPlotCounterPart1.textContent = Math.floor(plantPlot.getAmountOwned());}
    else{plantPlotCounterPart1.textContent = Math.floor(plantPlot.getAmountOwned());}
    if(plantPlot.getAmountOwned() === 1) {plantPlotCounterPart2.textContent = "Plant Plot";}
    else{plantPlotCounterPart2.textContent = "Plant Plots";}
    plantPlotPrice.textContent = plantPlot.getPrice() + " seeds";
}

function seedPerSecondCalculator() {
    seedsPerSecond = 0;
    seedsPerSecond += plantPlot.seedsPerSecondCalulation();
    if(seedsPerSecond === 1){seedPerSecondDisplay.textContent = seedsPerSecond + " seed per second";}
    else{seedPerSecondDisplay.textContent = seedsPerSecond + " seeds per second";}
}

function clickPlant(){
    if(!plantExists) {
        seeds -= 1;
    }
    plantExists = true;
    seeds += currentPlant.grow();
}

wake();

</script>
</body>
</html>